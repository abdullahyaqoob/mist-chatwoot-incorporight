{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{2849:function(n,e,t){\"use strict\";function i(n,e){var t,i;return\"boolean\"===typeof(null===e||void 0===e?void 0:e.enabled)?e.enabled:null===(i=null===(t=null===n||void 0===n?void 0:n.__default)||void 0===t?void 0:t.enabled)||void 0===i||i}t.d(e,\"a\",(function(){return i}))},3331:function(n,e,t){\"use strict\";t.r(e),t.d(e,\"schemaFilter\",(function(){return o}));var i=t(5),r=t(2849);function o(n,e){function t(t){var o=n,u=t.event.event;if(o&&u){var a=o[u];if(!Object(r.a)(o,a))return t.updateEvent(\"integrations\",Object(i.a)(Object(i.a)({},t.event.integrations),{All:!1,\"june.so\":!0})),t;var c=function(n,e){var t,i;if(!n||!Object.keys(n))return{};var r=n.integrations?Object.keys(n.integrations).filter((function(e){return!1===n.integrations[e]})):[],o=[];return(null!==(t=e.remotePlugins)&&void 0!==t?t:[]).forEach((function(n){r.forEach((function(e){(n.name.includes(e)||e.includes(n.name))&&o.push(n.name)}))})),(null!==(i=e.remotePlugins)&&void 0!==i?i:[]).reduce((function(n,e){return e.settings.subscriptions&&o.includes(e.name)&&e.settings.subscriptions.forEach((function(t){return n[\"\".concat(e.name,\" \").concat(t.partnerAction)]=!1})),n}),{})}(a,e);t.updateEvent(\"integrations\",Object(i.a)(Object(i.a)(Object(i.a)({},t.event.integrations),null===a||void 0===a?void 0:a.integrations),c))}return t}return{name:\"Schema Filter\",version:\"0.1.0\",isLoaded:function(){return!0},load:function(){return Promise.resolve()},type:\"before\",page:t,alias:t,track:t,identify:t,group:t}}}}]);","name":"js/schemaFilter-0e1af061a6893293716f.chunk.js","map":{"version":3,"names":["window","push","module","__webpack_exports__","__webpack_require__","isPlanEventEnabled","plan","planEvent","_a","_b","enabled","__default","d","r","schemaFilter","tslib__WEBPACK_IMPORTED_MODULE_0__","_lib_is_plan_event_enabled__WEBPACK_IMPORTED_MODULE_1__","track","settings","filter","ctx","ev","event","Object","updateEvent","integrations","All","disabledActions","keys","disabledIntegrations","i","disabledRemotePlugins","remotePlugins","forEach","p","int","name","includes","reduce","acc","sub","concat","partnerAction","disabledActionDestinations","version","isLoaded","load","Promise","resolve","type","page","alias","identify","group"],"sources":["js/schemaFilter-0e1af061a6893293716f.chunk.js"],"mappings":"CAACA,OAAqB,aAAIA,OAAqB,cAAK,IAAIC,KAAK,CAAC,CAAC,IAAI,CAE7D,KACA,SAAUC,EAAQC,EAAqBC,GAE7C,aAQA,SAASC,EAAmBC,EAAMC,GAChC,IAAIC,EAAIC,EAGR,MAAyF,mBAA/D,OAAdF,QAAoC,IAAdA,OAAuB,EAASA,EAAUG,SACnEH,EAAUG,QAIiH,QAA5HD,EAA2E,QAArED,EAAc,OAATF,QAA0B,IAATA,OAAkB,EAASA,EAAKK,iBAA8B,IAAPH,OAAgB,EAASA,EAAGE,eAA4B,IAAPD,GAAgBA,EAhB/HL,EAAoBQ,EAAET,EAAqB,KAAK,WAAa,OAAOE,MAqB7F,KACA,SAAUH,EAAQC,EAAqBC,GAE7C,aACAA,EAAoBS,EAAEV,GACSC,EAAoBQ,EAAET,EAAqB,gBAAgB,WAAa,OAAOW,KACzF,IAAIC,EAAqCX,EAAoB,GACzDY,EAA0DZ,EAAoB,MAuCvG,SAASU,EAAaG,EAAOC,GAC3B,SAASC,EAAOC,GACd,IAAId,EAAOW,EACPI,EAAKD,EAAIE,MAAMA,MAEnB,GAAIhB,GAAQe,EAAI,CACd,IAAId,EAAYD,EAAKe,GAErB,IAAKE,OAAOP,EAAoF,EAA3FO,CAA8FjB,EAAMC,GAKvG,OAJAa,EAAII,YAAY,eAAgBD,OAAOR,EAAqD,EAA5DQ,CAA+DA,OAAOR,EAAqD,EAA5DQ,CAA+D,GAAIH,EAAIE,MAAMG,cAAe,CACzLC,KAAK,EACL,WAAW,KAENN,EAEP,IAAIO,EAlDZ,SAAoCrB,EAAMY,GACxC,IAAIV,EAAIC,EAER,IAAKH,IAASiB,OAAOK,KAAKtB,GACxB,MAAO,GAGT,IAAIuB,EAAuBvB,EAAKmB,aAAeF,OAAOK,KAAKtB,EAAKmB,cAAcN,QAAO,SAAUW,GAC7F,OAAgC,IAAzBxB,EAAKmB,aAAaK,MACtB,GAGDC,EAAwB,GAQ5B,OAPmC,QAAjCvB,EAAKU,EAASc,qBAAkC,IAAPxB,EAAgBA,EAAK,IAAIyB,SAAQ,SAAUC,GACpFL,EAAqBI,SAAQ,SAAUE,IACjCD,EAAEE,KAAKC,SAASF,IAAQA,EAAIE,SAASH,EAAEE,QACzCL,EAAsB9B,KAAKiC,EAAEE,aAIO,QAAjC3B,EAAKS,EAASc,qBAAkC,IAAPvB,EAAgBA,EAAK,IAAI6B,QAAO,SAAUC,EAAKL,GAW/F,OAVIA,EAAEhB,SAAwB,eACxBa,EAAsBM,SAASH,EAAEE,OAEnCF,EAAEhB,SAAwB,cAAEe,SAC5B,SAAUO,GACR,OAAOD,EAAI,GAAGE,OAAOP,EAAEE,KAAM,KAAKK,OAAOD,EAAIE,iBAAkB,KAK9DH,IACN,IAkByBI,CAA2BpC,EAAWW,GAC5DE,EAAII,YAAY,eAAgBD,OAAOR,EAAqD,EAA5DQ,CAA+DA,OAAOR,EAAqD,EAA5DQ,CAA+DA,OAAOR,EAAqD,EAA5DQ,CAA+D,GAAIH,EAAIE,MAAMG,cAA6B,OAAdlB,QAAoC,IAAdA,OAAuB,EAASA,EAAUkB,cAAeE,IAI7U,OAAOP,EAGT,MAAO,CACLgB,KAAM,gBACNQ,QAAS,QACTC,SAAU,WACR,OAAO,GAETC,KAAM,WACJ,OAAOC,QAAQC,WAEjBC,KAAM,SACNC,KAAM/B,EACNgC,MAAOhC,EACPF,MAAOE,EACPiC,SAAUjC,EACVkC,MAAOlC"},"input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[27],{\n\n/***/ 2849:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return isPlanEventEnabled; });\n/**\n * Determines whether a track event is allowed to be sent based on the\n * user's tracking plan.\n * If the user does not have a tracking plan or the event is allowed based\n * on the tracking plan configuration, returns true.\n */\nfunction isPlanEventEnabled(plan, planEvent) {\n  var _a, _b; // Always prioritize the event's `enabled` status\n\n\n  if (typeof (planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === 'boolean') {\n    return planEvent.enabled;\n  } // Assume absence of a tracking plan means events are enabled\n\n\n  return (_b = (_a = plan === null || plan === void 0 ? void 0 : plan.__default) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n}\n\n/***/ }),\n\n/***/ 3331:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"schemaFilter\", function() { return schemaFilter; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var _lib_is_plan_event_enabled__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2849);\n\n\n\nfunction disabledActionDestinations(plan, settings) {\n  var _a, _b;\n\n  if (!plan || !Object.keys(plan)) {\n    return {};\n  }\n\n  var disabledIntegrations = plan.integrations ? Object.keys(plan.integrations).filter(function (i) {\n    return plan.integrations[i] === false;\n  }) : []; // This accounts for cases like Fullstory, where the settings.integrations\n  // contains a \"Fullstory\" object but settings.remotePlugins contains \"Fullstory (Actions)\"\n\n  var disabledRemotePlugins = [];\n  ((_a = settings.remotePlugins) !== null && _a !== void 0 ? _a : []).forEach(function (p) {\n    disabledIntegrations.forEach(function (int) {\n      if (p.name.includes(int) || int.includes(p.name)) {\n        disabledRemotePlugins.push(p.name);\n      }\n    });\n  });\n  return ((_b = settings.remotePlugins) !== null && _b !== void 0 ? _b : []).reduce(function (acc, p) {\n    if (p.settings['subscriptions']) {\n      if (disabledRemotePlugins.includes(p.name)) {\n        // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONObject\n        p.settings['subscriptions'].forEach( // @ts-expect-error parameter 'sub' implicitly has an 'any' type\n        function (sub) {\n          return acc[\"\".concat(p.name, \" \").concat(sub.partnerAction)] = false;\n        });\n      }\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction schemaFilter(track, settings) {\n  function filter(ctx) {\n    var plan = track;\n    var ev = ctx.event.event;\n\n    if (plan && ev) {\n      var planEvent = plan[ev];\n\n      if (!Object(_lib_is_plan_event_enabled__WEBPACK_IMPORTED_MODULE_1__[/* isPlanEventEnabled */ \"a\"])(plan, planEvent)) {\n        ctx.updateEvent('integrations', Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])({}, ctx.event.integrations), {\n          All: false,\n          'june.so': true\n        }));\n        return ctx;\n      } else {\n        var disabledActions = disabledActionDestinations(planEvent, settings);\n        ctx.updateEvent('integrations', Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations), disabledActions));\n      }\n    }\n\n    return ctx;\n  }\n\n  return {\n    name: 'Schema Filter',\n    version: '0.1.0',\n    isLoaded: function isLoaded() {\n      return true;\n    },\n    load: function load() {\n      return Promise.resolve();\n    },\n    type: 'before',\n    page: filter,\n    alias: filter,\n    track: filter,\n    identify: filter,\n    group: filter\n  };\n}\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["/home/chatwoot/chatwoot/node_modules/babel-loader/lib/index.js??ref--6-0!/home/chatwoot/chatwoot/node_modules/@june-so/analytics-next/dist/pkg/lib/is-plan-event-enabled.js","/home/chatwoot/chatwoot/node_modules/babel-loader/lib/index.js??ref--6-0!/home/chatwoot/chatwoot/node_modules/@june-so/analytics-next/dist/pkg/plugins/schema-filter/index.js"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,aAAa;;;AAGb;AACA;AACA,GAAG;;;AAGH;AACA,C;;;;;;;;AChBA;AAAA;AAAA;AAAA;AAAiC;AACoC;;AAErE;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG,OAAO;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA,GAAG,IAAI;AACP;;AAEO;AACP;AACA;AACA;;AAEA;AACA;;AAEA,WAAW,6FAAkB;AAC7B,wCAAwC,8DAAQ,CAAC,8DAAQ,GAAG;AAC5D;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA,wCAAwC,8DAAQ,CAAC,8DAAQ,CAAC,8DAAQ,GAAG;AACrE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C","file":"x","sourcesContent":["/**\n * Determines whether a track event is allowed to be sent based on the\n * user's tracking plan.\n * If the user does not have a tracking plan or the event is allowed based\n * on the tracking plan configuration, returns true.\n */\nexport function isPlanEventEnabled(plan, planEvent) {\n  var _a, _b; // Always prioritize the event's `enabled` status\n\n\n  if (typeof (planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === 'boolean') {\n    return planEvent.enabled;\n  } // Assume absence of a tracking plan means events are enabled\n\n\n  return (_b = (_a = plan === null || plan === void 0 ? void 0 : plan.__default) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n}","import { __assign } from \"tslib\";\nimport { isPlanEventEnabled } from '../../lib/is-plan-event-enabled';\n\nfunction disabledActionDestinations(plan, settings) {\n  var _a, _b;\n\n  if (!plan || !Object.keys(plan)) {\n    return {};\n  }\n\n  var disabledIntegrations = plan.integrations ? Object.keys(plan.integrations).filter(function (i) {\n    return plan.integrations[i] === false;\n  }) : []; // This accounts for cases like Fullstory, where the settings.integrations\n  // contains a \"Fullstory\" object but settings.remotePlugins contains \"Fullstory (Actions)\"\n\n  var disabledRemotePlugins = [];\n  ((_a = settings.remotePlugins) !== null && _a !== void 0 ? _a : []).forEach(function (p) {\n    disabledIntegrations.forEach(function (int) {\n      if (p.name.includes(int) || int.includes(p.name)) {\n        disabledRemotePlugins.push(p.name);\n      }\n    });\n  });\n  return ((_b = settings.remotePlugins) !== null && _b !== void 0 ? _b : []).reduce(function (acc, p) {\n    if (p.settings['subscriptions']) {\n      if (disabledRemotePlugins.includes(p.name)) {\n        // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONObject\n        p.settings['subscriptions'].forEach( // @ts-expect-error parameter 'sub' implicitly has an 'any' type\n        function (sub) {\n          return acc[\"\".concat(p.name, \" \").concat(sub.partnerAction)] = false;\n        });\n      }\n    }\n\n    return acc;\n  }, {});\n}\n\nexport function schemaFilter(track, settings) {\n  function filter(ctx) {\n    var plan = track;\n    var ev = ctx.event.event;\n\n    if (plan && ev) {\n      var planEvent = plan[ev];\n\n      if (!isPlanEventEnabled(plan, planEvent)) {\n        ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), {\n          All: false,\n          'june.so': true\n        }));\n        return ctx;\n      } else {\n        var disabledActions = disabledActionDestinations(planEvent, settings);\n        ctx.updateEvent('integrations', __assign(__assign(__assign({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations), disabledActions));\n      }\n    }\n\n    return ctx;\n  }\n\n  return {\n    name: 'Schema Filter',\n    version: '0.1.0',\n    isLoaded: function isLoaded() {\n      return true;\n    },\n    load: function load() {\n      return Promise.resolve();\n    },\n    type: 'before',\n    page: filter,\n    alias: filter,\n    track: filter,\n    identify: filter,\n    group: filter\n  };\n}"]}}