{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{3332:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"remoteMiddlewares\",(function(){return o}));var r=n(5),c=n(298),a=n(305),i=n(261);function o(e,t,n){var o;return Object(r.b)(this,void 0,void 0,(function(){var s,u,l,d,b=this;return Object(r.d)(this,(function(w){switch(w.label){case 0:return Object(c.b)()?[2,[]]:(s=Object(i.b)(),u=null!==(o=t.enabledMiddleware)&&void 0!==o?o:{},l=Object.entries(u).filter((function(e){e[0];return e[1]})).map((function(e){return e[0]})),d=l.map((function(t){return Object(r.b)(b,void 0,void 0,(function(){var c,i,o,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:c=t.replace(\"@segment/\",\"\"),i=c,n&&(i=btoa(c).replace(/=/g,\"\")),o=\"\".concat(s,\"/middleware/\").concat(i,\"/latest/\").concat(i,\".js.gz\"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(o)];case 2:return r.sent(),[2,window[\"\".concat(c,\"Middleware\")]];case 3:return u=r.sent(),e.log(\"error\",u),e.stats.increment(\"failed_remote_middleware\"),[3,4];case 4:return[2]}}))}))})),[4,Promise.all(d)]);case 1:return[2,w.sent().filter(Boolean)]}}))}))}}}]);","name":"js/remoteMiddleware-9738ae98689f5ef0feb4.chunk.js","map":{"version":3,"names":["window","push","module","__webpack_exports__","__webpack_require__","r","d","remoteMiddlewares","tslib__WEBPACK_IMPORTED_MODULE_0__","_core_environment__WEBPACK_IMPORTED_MODULE_1__","_lib_load_script__WEBPACK_IMPORTED_MODULE_2__","_lib_parse_cdn__WEBPACK_IMPORTED_MODULE_3__","ctx","settings","obfuscate","_a","Object","this","path","remoteMiddleware","names","scripts","_this","_b","label","enabledMiddleware","entries","filter","map","name","nonNamespaced","bundleName","fullPath","error_1","replace","btoa","concat","trys","sent","log","stats","increment","Promise","all","Boolean"],"sources":["js/remoteMiddleware-9738ae98689f5ef0feb4.chunk.js"],"mappings":"CAACA,OAAqB,aAAIA,OAAqB,cAAK,IAAIC,KAAK,CAAC,CAAC,IAAI,CAE7D,KACA,SAAUC,EAAQC,EAAqBC,GAE7C,aACAA,EAAoBC,EAAEF,GACSC,EAAoBE,EAAEH,EAAqB,qBAAqB,WAAa,OAAOI,KAC9F,IAAIC,EAAqCJ,EAAoB,GACzDK,EAAiDL,EAAoB,KACrEM,EAAgDN,EAAoB,KACpEO,EAA8CP,EAAoB,KAK3F,SAASG,EAAkBK,EAAKC,EAAUC,GACxC,IAAIC,EAEJ,OAAOC,OAAOR,EAAsD,EAA7DQ,CAAgEC,UAAM,OAAQ,GAAQ,WAC3F,IAAIC,EAAMC,EAAkBC,EAAOC,EAE/BC,EAAQL,KAEZ,OAAOD,OAAOR,EAAwD,EAA/DQ,CAAkEC,MAAM,SAAUM,GACvF,OAAQA,EAAGC,OACT,KAAK,EACH,OAAIR,OAAOP,EAAiE,EAAxEO,GACK,CAAC,EAEN,KAGJE,EAAOF,OAAOL,EAA4E,EAAnFK,GACPG,EAAyD,QAArCJ,EAAKF,EAASY,yBAAsC,IAAPV,EAAgBA,EAAK,GACtFK,EAAQJ,OAAOU,QAAQP,GAAkBQ,QAAO,SAAUZ,GAChDA,EAAG,GAEX,OADcA,EAAG,MAEhBa,KAAI,SAAUb,GAEf,OADWA,EAAG,MAGhBM,EAAUD,EAAMQ,KAAI,SAAUC,GAC5B,OAAOb,OAAOR,EAAsD,EAA7DQ,CAAgEM,OAAO,OAAQ,GAAQ,WAC5F,IAAIQ,EAAeC,EAAYC,EAAUC,EACzC,OAAOjB,OAAOR,EAAwD,EAA/DQ,CAAkEC,MAAM,SAAUF,GACvF,OAAQA,EAAGS,OACT,KAAK,EACHM,EAAgBD,EAAKK,QAAQ,YAAa,IAC1CH,EAAaD,EAEThB,IACFiB,EAAaI,KAAKL,GAAeI,QAAQ,KAAM,KAGjDF,EAAW,GAAGI,OAAOlB,EAAM,gBAAgBkB,OAAOL,EAAY,YAAYK,OAAOL,EAAY,UAC7FhB,EAAGS,MAAQ,EAEb,KAAK,EAGH,OAFAT,EAAGsB,KAAKpC,KAAK,CAAC,EAAG,EAAE,CAAE,IAEd,CAAC,EAENe,OAAON,EAAkE,EAAzEM,CAA4EgB,IAGhF,KAAK,EAIH,OAHAjB,EAAGuB,OAGI,CAAC,EAENtC,OAAO,GAAGoC,OAAON,EAAe,gBAEpC,KAAK,EAIH,OAHAG,EAAUlB,EAAGuB,OACb1B,EAAI2B,IAAI,QAASN,GACjBrB,EAAI4B,MAAMC,UAAU,4BACb,CAAC,EAEN,GAEJ,KAAK,EACH,MAAO,CAAC,aAOX,CAAC,EAENC,QAAQC,IAAItB,KAEhB,KAAK,EAGH,MAAO,CAAC,EAFKE,EAAGe,OACQX,OAAOiB"},"input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[26],{\n\n/***/ 3332:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"remoteMiddlewares\", function() { return remoteMiddlewares; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var _core_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(298);\n/* harmony import */ var _lib_load_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(305);\n/* harmony import */ var _lib_parse_cdn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(261);\n\n\n\n\nfunction remoteMiddlewares(ctx, settings, obfuscate) {\n  var _a;\n\n  return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"b\"])(this, void 0, void 0, function () {\n    var path, remoteMiddleware, names, scripts, middleware;\n\n    var _this = this;\n\n    return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __generator */ \"d\"])(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (Object(_core_environment__WEBPACK_IMPORTED_MODULE_1__[/* isServer */ \"b\"])()) {\n            return [2\n            /*return*/\n            , []];\n          }\n\n          path = Object(_lib_parse_cdn__WEBPACK_IMPORTED_MODULE_3__[/* getNextIntegrationsURL */ \"b\"])();\n          remoteMiddleware = (_a = settings.enabledMiddleware) !== null && _a !== void 0 ? _a : {};\n          names = Object.entries(remoteMiddleware).filter(function (_a) {\n            var _ = _a[0],\n                enabled = _a[1];\n            return enabled;\n          }).map(function (_a) {\n            var name = _a[0];\n            return name;\n          });\n          scripts = names.map(function (name) {\n            return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"b\"])(_this, void 0, void 0, function () {\n              var nonNamespaced, bundleName, fullPath, error_1;\n              return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __generator */ \"d\"])(this, function (_a) {\n                switch (_a.label) {\n                  case 0:\n                    nonNamespaced = name.replace('@segment/', '');\n                    bundleName = nonNamespaced;\n\n                    if (obfuscate) {\n                      bundleName = btoa(nonNamespaced).replace(/=/g, '');\n                    }\n\n                    fullPath = \"\".concat(path, \"/middleware/\").concat(bundleName, \"/latest/\").concat(bundleName, \".js.gz\");\n                    _a.label = 1;\n\n                  case 1:\n                    _a.trys.push([1, 3,, 4]);\n\n                    return [4\n                    /*yield*/\n                    , Object(_lib_load_script__WEBPACK_IMPORTED_MODULE_2__[/* loadScript */ \"a\"])(fullPath) // @ts-ignore\n                    ];\n\n                  case 2:\n                    _a.sent(); // @ts-ignore\n\n\n                    return [2\n                    /*return*/\n                    , window[\"\".concat(nonNamespaced, \"Middleware\")]];\n\n                  case 3:\n                    error_1 = _a.sent();\n                    ctx.log('error', error_1);\n                    ctx.stats.increment('failed_remote_middleware');\n                    return [3\n                    /*break*/\n                    , 4];\n\n                  case 4:\n                    return [2\n                    /*return*/\n                    ];\n                }\n              });\n            });\n          });\n          return [4\n          /*yield*/\n          , Promise.all(scripts)];\n\n        case 1:\n          middleware = _b.sent();\n          middleware = middleware.filter(Boolean);\n          return [2\n          /*return*/\n          , middleware];\n      }\n    });\n  });\n}\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["/home/chatwoot/chatwoot/node_modules/babel-loader/lib/index.js??ref--6-0!/home/chatwoot/chatwoot/node_modules/@june-so/analytics-next/dist/pkg/plugins/remote-middleware/index.js"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACG;AACC;AACU;AACtD;AACP;;AAEA,SAAS,+DAAS;AAClB;;AAEA;;AAEA,WAAW,iEAAW;AACtB;AACA;AACA,cAAc,0EAAQ;AACtB;AACA;AACA;AACA;;AAEA,iBAAiB,qFAAsB;AACvC;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA,mBAAmB,+DAAS;AAC5B;AACA,qBAAqB,iEAAW;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAsB,2EAAU;AAChC;;AAEA;AACA,8BAA8B;;;AAG9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,C","file":"x","sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { isServer } from '../../core/environment';\nimport { loadScript } from '../../lib/load-script';\nimport { getNextIntegrationsURL } from '../../lib/parse-cdn';\nexport function remoteMiddlewares(ctx, settings, obfuscate) {\n  var _a;\n\n  return __awaiter(this, void 0, void 0, function () {\n    var path, remoteMiddleware, names, scripts, middleware;\n\n    var _this = this;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (isServer()) {\n            return [2\n            /*return*/\n            , []];\n          }\n\n          path = getNextIntegrationsURL();\n          remoteMiddleware = (_a = settings.enabledMiddleware) !== null && _a !== void 0 ? _a : {};\n          names = Object.entries(remoteMiddleware).filter(function (_a) {\n            var _ = _a[0],\n                enabled = _a[1];\n            return enabled;\n          }).map(function (_a) {\n            var name = _a[0];\n            return name;\n          });\n          scripts = names.map(function (name) {\n            return __awaiter(_this, void 0, void 0, function () {\n              var nonNamespaced, bundleName, fullPath, error_1;\n              return __generator(this, function (_a) {\n                switch (_a.label) {\n                  case 0:\n                    nonNamespaced = name.replace('@segment/', '');\n                    bundleName = nonNamespaced;\n\n                    if (obfuscate) {\n                      bundleName = btoa(nonNamespaced).replace(/=/g, '');\n                    }\n\n                    fullPath = \"\".concat(path, \"/middleware/\").concat(bundleName, \"/latest/\").concat(bundleName, \".js.gz\");\n                    _a.label = 1;\n\n                  case 1:\n                    _a.trys.push([1, 3,, 4]);\n\n                    return [4\n                    /*yield*/\n                    , loadScript(fullPath) // @ts-ignore\n                    ];\n\n                  case 2:\n                    _a.sent(); // @ts-ignore\n\n\n                    return [2\n                    /*return*/\n                    , window[\"\".concat(nonNamespaced, \"Middleware\")]];\n\n                  case 3:\n                    error_1 = _a.sent();\n                    ctx.log('error', error_1);\n                    ctx.stats.increment('failed_remote_middleware');\n                    return [3\n                    /*break*/\n                    , 4];\n\n                  case 4:\n                    return [2\n                    /*return*/\n                    ];\n                }\n              });\n            });\n          });\n          return [4\n          /*yield*/\n          , Promise.all(scripts)];\n\n        case 1:\n          middleware = _b.sent();\n          middleware = middleware.filter(Boolean);\n          return [2\n          /*return*/\n          , middleware];\n      }\n    });\n  });\n}"]}}